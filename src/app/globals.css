@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 0 0% 3.9%;
    --card: 0 0% 100%;
    --card-foreground: 0 0% 3.9%;
    --popover: 0 0% 100%;
    --popover-foreground: 0 0% 3.9%;
    --primary: 217 91% 60%;
    --primary-foreground: 0 0% 98%;
    --secondary: 0 0% 96.1%;
    --secondary-foreground: 0 0% 9%;
    --muted: 0 0% 96.1%;
    --muted-foreground: 0 0% 45.1%;
    --accent: 0 0% 96.1%;
    --accent-foreground: 0 0% 9%;
    --border: 0 0% 89.8%;
    --input: 0 0% 89.8%;
    --ring: 217 91% 60%;
    --radius: 0.5rem;
  }

  .dark {
    --background: 224 71% 4%;
    --foreground: 213 31% 91%;
    --card: 224 71% 4%;
    --card-foreground: 213 31% 91%;
    --popover: 224 71% 4%;
    --popover-foreground: 213 31% 91%;
    --primary: 217 91% 60%;
    --primary-foreground: 0 0% 98%;
    --secondary: 215 28% 17%;
    --secondary-foreground: 213 31% 91%;
    --muted: 215 28% 17%;
    --muted-foreground: 215 20% 65%;
    --accent: 215 28% 17%;
    --accent-foreground: 213 31% 91%;
    --border: 215 28% 17%;
    --input: 215 28% 17%;
    --ring: 217 91% 60%;
  }

  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground;
    font-feature-settings: 'rlig' 1, 'calt' 1;
  }
}

@layer utilities {
  .text-balance {
    text-wrap: balance;
  }
}

/* =============================================
   VIEW TRANSITIONS API STYLES
   ============================================= */

/* Default crossfade for page content */
::view-transition-old(page-content),
::view-transition-new(page-content) {
  animation-duration: 0.3s;
  animation-timing-function: ease-in-out;
}

::view-transition-old(page-content) {
  animation-name: fade-out;
}

::view-transition-new(page-content) {
  animation-name: fade-in;
}

/* Header stays fixed during transitions */
::view-transition-old(header),
::view-transition-new(header) {
  animation: none;
  mix-blend-mode: normal;
}

@keyframes fade-out {
  from { opacity: 1; }
  to { opacity: 0; }
}

@keyframes fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* =============================================
   SCROLL-DRIVEN ANIMATIONS
   ============================================= */

/* Fade in when entering viewport */
.animate-on-scroll {
  opacity: 0;
  transform: translateY(20px);
  animation: scroll-fade-in linear both;
  animation-timeline: view();
  animation-range: entry 0% entry 30%;
}

@keyframes scroll-fade-in {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Scale + fade in variant */
.animate-on-scroll-scale {
  opacity: 0;
  transform: translateY(30px) scale(0.95);
  animation: scroll-scale-in linear both;
  animation-timeline: view();
  animation-range: entry 0% entry 40%;
}

@keyframes scroll-scale-in {
  from {
    opacity: 0;
    transform: translateY(30px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

/* Parallax effects for decorative elements */
.parallax-slow {
  animation: parallax-move linear both;
  animation-timeline: scroll();
  animation-range: 0% 100%;
}

@keyframes parallax-move {
  from {
    transform: translateY(0);
  }
  to {
    transform: translateY(-50px);
  }
}

.parallax-medium {
  animation: parallax-move-medium linear both;
  animation-timeline: scroll();
  animation-range: 0% 100%;
}

@keyframes parallax-move-medium {
  from {
    transform: translateY(0);
  }
  to {
    transform: translateY(-100px);
  }
}

/* Scroll progress indicator */
.scroll-progress {
  transform-origin: left;
  animation: scroll-progress-grow linear both;
  animation-timeline: scroll();
}

@keyframes scroll-progress-grow {
  from {
    transform: scaleX(0);
  }
  to {
    transform: scaleX(1);
  }
}

/* Fallback for browsers without scroll-driven animations */
@supports not (animation-timeline: view()) {
  .animate-on-scroll,
  .animate-on-scroll-scale {
    opacity: 1;
    transform: none;
  }

  .parallax-slow,
  .parallax-medium {
    animation: none;
  }

  .scroll-progress {
    transform: scaleX(1);
  }
}

/* =============================================
   3D INTRO BOX ANIMATION
   ============================================= */

.perspective-1000 {
  perspective: 1000px;
}

.intro-cube {
  position: relative;
  width: 120px;
  height: 120px;
  transform-style: preserve-3d;
  animation: cube-rotate 8s infinite linear;
}

.intro-cube:hover {
  animation-play-state: paused;
}

.intro-cube-face {
  position: absolute;
  width: 120px;
  height: 120px;
  border: 2px solid rgba(59, 130, 246, 0.3);
  border-radius: 12px;
  background: linear-gradient(135deg, rgba(23, 23, 23, 0.95) 0%, rgba(38, 38, 38, 0.95) 100%);
  backdrop-filter: blur(10px);
  display: flex;
  align-items: center;
  justify-content: center;
  backface-visibility: visible;
  box-shadow:
    0 0 20px rgba(59, 130, 246, 0.1),
    inset 0 0 20px rgba(59, 130, 246, 0.05);
}

.intro-cube-front  { transform: rotateY(0deg) translateZ(60px); }
.intro-cube-back   { transform: rotateY(180deg) translateZ(60px); }
.intro-cube-right  { transform: rotateY(90deg) translateZ(60px); }
.intro-cube-left   { transform: rotateY(-90deg) translateZ(60px); }
.intro-cube-top    { transform: rotateX(90deg) translateZ(60px); }
.intro-cube-bottom { transform: rotateX(-90deg) translateZ(60px); }

@keyframes cube-rotate {
  0% {
    transform: rotateX(-20deg) rotateY(0deg);
  }
  100% {
    transform: rotateX(-20deg) rotateY(360deg);
  }
}

/* Hover state - stop and tilt */
.intro-cube:hover {
  transform: rotateX(-10deg) rotateY(-20deg);
}

/* Reduced motion: show static cube */
@media (prefers-reduced-motion: reduce) {
  .intro-cube {
    animation: none;
    transform: rotateX(-20deg) rotateY(-20deg);
  }
}

/* =============================================
   GENERAL REDUCED MOTION PREFERENCES
   ============================================= */

/* Respect user's motion preferences */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }

  ::view-transition-old(*),
  ::view-transition-new(*) {
    animation: none !important;
  }

  .animate-on-scroll,
  .animate-on-scroll-scale {
    opacity: 1;
    transform: none;
  }

  .parallax-slow,
  .parallax-medium {
    animation: none;
  }
}
